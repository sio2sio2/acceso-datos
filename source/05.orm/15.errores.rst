.. _orm-exp:

Excepciones
***********
|JPA| define su propio conjunto de excepciones derivadas todas de
:jakarta-persistence:`PersistenceException`, que a su vez deriva
de :java-lang:`RuntimeException <RuntimeException>`. Hay que tener en cuenta
dos particularidades:

+ Que todas deriven en última instancia de :java-lang:`RuntimeException
  <RuntimeException>`, supone que las excepciones de este |ORM|, a diferencia de
  las de :ref:`JBDC <conn>`, no son comprobadas; y, por tanto, no es necesario
  capturarlas o declararlas a través de ``throws``.

+ Cuando se genera una excepción, la sesión suele quedar en estado
  inconsistente, por lo que conviene cerrarla y comenzar una nueva.

.. rubric:: Excepciones comunes

Una lista no exhaustiva de excepciones es esta:

:jakarta-persistence:`NoResultException`, :jakarta-persistence:`NonUniqueResultException`
   Se producen cuando se espera un único resultado (véase
   :ref:`.getSingleResult() <orm-singleresult>`) y no se obtiene eso.

:jakarta-persistence:`OptimisticLockException`
   Esta relacionada con problemas de concurrencia: se lanza cuando se detecta
   que una entidad se modificó por otra transacción después de haber sido
   recuperada por la actual.

:jakarta-persistence:`RollbackException`
   Se produce cuando una transacción no puede confirmarse, por lo general por
   violarse restricciones en los valores de los campos.

:jakarta-persistence:`TransactionRequiredException`
   Se lanza cuando se intenta hacer una operación de escritura sin haber
   iniciado una transacción.

Dependiendo de qué proveedor se use, además de las genéricas, pueden lanzarse
otras, como estas específicas de Hibernate_:

:hibernate-api:`JDBCConnectionException <exception/JDBCConnectionException>`
   Producida por problemas en la conexión a la base de datos como que ésta no
   exista o no haya conectividad o las credenciales sean inválidas.

:hibernate-api:`LazyInitializationException <LazyInitializationException>`
   Se produce cuando se intenta resolver una relación perezosa sin que el objeto
   esté asociado a la sesión activa.

.. |ORM| replace:: :abbr:`ORM (Object-Relational Mapping)`
.. |JPA| replace:: :abbr:`JPA (Java Persistence API)`
.. _Hibernate: https://hibernate.org/
