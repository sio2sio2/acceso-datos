


<!DOCTYPE html>


<html lang="es" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Sistema de registros &#8212; documentación de Acceso a datos - rolling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" href="../_static/general.css" type="text/css" />
    <link rel="stylesheet" href="../_static/particular.css" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=461dccb6"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=677778c1"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/translations.js?v=f85f4cfb"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '98.apendices/10.logging';</script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="4. Maven" href="80.maven.html" />
    <link rel="prev" title="2. Patrones de diseño" href="05.pattern.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Saltar al contenido principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Volver arriba</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Advertencia de versión"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="documentación de Acceso a datos - rolling - Home"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="documentación de Acceso a datos - rolling - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Búsqueda</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01.archivos/index.html">1. Tratamiento de archivos</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../01.archivos/01.gestion.html">1.1. Gestión de archivos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01.archivos/02.manipulacion.html">1.2. Consulta y manipulación de contenidos</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02.formatos/index.html">2. Formatos de información</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../02.formatos/01.csv.html">2.1. <abbr title="Comma-Separated Values">CSV</abbr></a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../02.formatos/02.json.html">2.2. <abbr title="JavaScript Object Notation">JSON</abbr></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../02.formatos/02.json/01.gson.html">2.2.1. GSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02.formatos/02.json/02.jackson.html">2.2.2. Jackson</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../02.formatos/03.yaml.html">2.3. <abbr title="YAML Ain't Markup Language">YAML</abbr></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03.xml/index.html">3. <abbr title="eXtensible Markup Language">XML</abbr></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03.xml/01.jaxp.html">3.1. <abbr title="Java API for XML Processing">JAXP</abbr></a></li>
<li class="toctree-l2"><a class="reference internal" href="../03.xml/02.jackson.html">3.2. Jackson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03.xml/03.basex.html">3.3. BaseX</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04.conector/index.html">4. Conectores</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04.conector/01.basico.html">4.1. Operaciones básicas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04.conector/02.datos.html">4.2. Datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04.conector/03.transacciones.html">4.3. Transacciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04.conector/04.pool.html">4.4. <em>Pool</em> de conexiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04.conector/10.extras.html">4.5. Extras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04.conector/15.dao.html">4.6. Programación con conectores</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05.orm/index.html">5. Herramientas <abbr title="Object-Relational Mapping">ORM</abbr></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../05.orm/01.conf.html">5.1. Configuración</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05.orm/02.basico.html">5.2. Operativa básica</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05.orm/03.conexion.html">5.3. Conexión</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05.orm/04.mapeo.html">5.4. Mapeo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05.orm/08.transaction.html">5.5. Transacciones</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../05.orm/10.crud.html">5.6. Operaciones <abbr title="Create, Read, Update, Delete">CRUD</abbr></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../05.orm/10.crud/01.simples.html">5.6.1. Simples</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../05.orm/10.crud/02.avanzadas.html">5.6.2. Avanzadas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../05.orm/10.crud/02.avanzadas/01.hql.html">5.6.2.1. <abbr title="Java Persistence Query Language">JPQL</abbr></a></li>
<li class="toctree-l4"><a class="reference internal" href="../05.orm/10.crud/02.avanzadas/02.criteria.html">5.6.2.2. Criteria API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../05.orm/10.crud/02.avanzadas/03.nativo.html">5.6.2.3. <abbr title="Structured Query Language">SQL</abbr> nativo</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../05.orm/15.extra.html">5.7. Otros aspectos</a></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../99.ejercicios/index.html">Ejercicios</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../99.ejercicios/01.achivos.html">1. Archivos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../99.ejercicios/02.formatos.html">2. Formatos de información</a></li>
<li class="toctree-l2"><a class="reference internal" href="../99.ejercicios/03.xml.html">3. Formato <abbr title="eXtensible Markup Language">XML</abbr></a></li>
<li class="toctree-l2"><a class="reference internal" href="../99.ejercicios/04.conectores.html">4. <abbr title="Java DataBase Connectivity">JDBC</abbr></a></li>
<li class="toctree-l2"><a class="reference internal" href="../99.ejercicios/05.orm.html">5. <abbr title="Java Persistent API">JPA</abbr></a></li>
</ul>
</details></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Apéndices</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="01.funcional.html">1. Java funcional</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="01.funcional/01.function.html">1.1. Interfaces funcionales</a></li>
<li class="toctree-l3"><a class="reference internal" href="01.funcional/05.collection.html">1.2. Colecciones</a></li>
<li class="toctree-l3"><a class="reference internal" href="01.funcional/10.flujos.html">1.3. Flujos</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="05.pattern.html">2. Patrones de diseño</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3. Sistema de registros</a></li>
<li class="toctree-l2"><a class="reference internal" href="80.maven.html">4. Maven</a></li>
<li class="toctree-l2"><a class="reference internal" href="99.ide.html">5. Visual Studio Code</a></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../97.orientaciones/index.html">Orientaciones pedagógicas</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/98.apendices/10.logging.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sistema de registros</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminares">3.1. Preliminares</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencias">3.1.1. Dependencias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-mensajes">3.1.2. Clasificación de mensajes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#envio-de-mensajes">3.2. Envío de mensajes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracion-adicional">3.3. Configuración adicional</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estatica">3.3.1. Estática</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinamica">3.3.2. Dinámica</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particularidades">3.4. Particularidades</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrado-por-severidad">3.4.1. Filtrado por severidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#puenteo-de-librerias">3.4.2. Puenteo de librerías</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="sistema-de-registros">
<span id="logging"></span><h1><span class="section-number">3. </span>Sistema de registros<a class="headerlink" href="#sistema-de-registros" title="Link to this heading">#</a></h1>
<p>Un aspecto fundamental en cualquier aplicación es que incluya un sistema sólido
de registros (<em>logs</em> como se dice habitualmente en inglés), a fin de que el
usuario pueda comprobar su funcionamiento. Téngase presente que, además de
fundamental, es transversal y cualquier código (lo que incluye librerías de
terceros que podamos usar en nuestro programa) es probable que necesite usarlo.
A pesar de ello y de lo que ocurre con otros aspectos (véase <a class="reference internal" href="../05.orm/index.html#orm"><span class="std std-ref">el uso de ORM</span></a>), <em>Java</em> no presenta una especificación general a la que puedan acogerse
las distintas librerías de implementación.</p>
<p>En vez de la especificación, desde su versión 1.4, <abbr title="Java Development Kit">JDK</abbr> incluye una librería de
implementación comúnmente llamada <abbr title="java.util.logging">JUL</abbr> que podría ser una solución… si fuera
lo suficientemente buena. En cambio, el hecho de <a class="reference external" href="https://stackoverflow.com/questions/11359187/why-not-use-java-util-logging">cosechar muchísimas críticas</a>
ha provocado la aparición de librerías de terceros, lo que ha fragmentado la
generación de registros y ha provocado que una aplicación pueda acabar usando
múltiples librerías de implementación distintas, ya que su desarrollador ha
podido escoger una para su código, pero necesitar librerías de terceros que
hagan uso de implementaciones distintas.</p>
<p>En cualquier caso, antes de proseguir, convendría aclarar qué queremos decir
con especificación e implementación.</p>
<dl class="simple">
<dt><em class="dfn">Especificación</em></dt><dd><p>Es simplemente una <abbr title="Application Programming Interface">API</abbr> que define las clases y los métodos que deben usarse
para expresar todas las operaciones que resuelven un problema.</p>
</dd>
<dt><em class="dfn">Librería de implementación</em> (o <em class="dfn">framework</em>)</dt><dd><p>Es una librería que realmente desarrolla la solución al problema. Puede
presentar su propia <abbr title="Application Programming Interface">API</abbr> o acogerse a una especificación definida o ambas
cosas, por supuesto.</p>
</dd>
</dl>
<p><em>Java</em>, a través de terceros, tiene definidas algunas especificaciones y algunas
librerías de implementación<a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, pero dado el carácter eminentemente práctico
de este apéndice nos centraremos en aconsejar sin más una posible elección:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.slf4j.org/">SLF4J</a> como <em>especificación</em>.</p></li>
<li><p><a class="reference external" href="https://logback.qos.ch/">Logback</a> como <em>implementación</em> o, en la
terminología de <abbr title="Simple Logging Facade For Java">SLF4J</abbr>, como proveedor. La librería la ha desarrollado el
mismo programador que <abbr title="Simple Logging Facade For Java">SLF4J</abbr> con lo que no presenta una interfaz alternativa.</p></li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Prudencia</p>
<p>La especificación se limita a definir cómo se envían mensajes al
sistema de registros, pero no entra en aspectos de configuración. Por tanto:</p>
<div class="pst-scrollable-table-container"><table class="table" id="aspectos-logging">
<thead>
<tr class="row-odd"><th class="head"><p>Aspecto</p></th>
<th class="head"><p>Definición</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Envío de mensajes</p></td>
<td><p>Común (definida por la implemtación)</p></td>
</tr>
<tr class="row-odd"><td><p>Nivel registrable</p></td>
<td rowspan="3"><p>Propio de cada implementación</p></td>
</tr>
<tr class="row-even"><td><p>Soporte de salida</p></td>
</tr>
<tr class="row-odd"><td><p>Formato de mensaje</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Es interesantísimo y esclarecedor el artículo <a class="reference external" href="https://www.marcobehler.com/guides/java-logging">How To Do Logging in
Java</a> incluido en las
<a class="reference external" href="https://www.marcobehler.com/guides/java-logging">Guías poco convencionales de Marco Behler</a>. El presente texto lo ha
tomado inicialmente como base.</p>
</div>
<section id="preliminares">
<h2><span class="section-number">3.1. </span>Preliminares<a class="headerlink" href="#preliminares" title="Link to this heading">#</a></h2>
<p>Antes de empezar de lleno conviene saber cómo empezar a usar el sistema de
registros.</p>
<section id="dependencias">
<h3><span class="section-number">3.1.1. </span>Dependencias<a class="headerlink" href="#dependencias" title="Link to this heading">#</a></h3>
<p>En nuestro proyecto deberemos enlazar al menos con:</p>
<ul class="simple">
<li><p>La interfaz de la especificación de <abbr title="Simple Logging Facade For Java">SLF4J</abbr>, esto es, <a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api">slf4j-api</a>.</p></li>
<li><p>El proveedor que proporciona una implementación: <a class="reference external" href="https://mvnrepository.com/artifact/ch.qos.logback/logback-classic">logback-classic</a>,
<a class="reference external" href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core">log4j-core</a>, etc. También podemos usar <a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-simple">slf4j-simple</a> que es una implementación
muy básica que sólo permite mostrar los mensajes por la salida de errores y no
nos permite cambiar el <a class="reference internal" href="#loglevel"><span class="std std-ref">nivel</span></a>, por lo que siempre se
mostrarán errores hasta el nivel <em>INFO</em>. Si usamos como implementación <abbr title="java.util.logging">JUL</abbr> no
necesitaremos cargar ninguna librería de terceros, puesto que ya está incluida
en <abbr title="Java Development Kit">JDK</abbr>.</p></li>
<li><p>La librería que permite vincular la implementación a <abbr title="Simple Logging Facade For Java">SLF4J</abbr>: <a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-reload4j">slf4j-reload4j</a>
para <a class="reference external" href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core">log4j-core</a>, <a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/jul-to-slf4j">jul-to-slf4j</a> para <abbr title="java.util.logging">JUL</abbr>. Ni <a class="reference external" href="https://logback.qos.ch/">Logback</a> ni <a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-simple">slf4j-simple</a>
necesitan ninguna vinculación adicional.</p></li>
</ul>
<p>En resumen:</p>
<div class="pst-scrollable-table-container"><table class="table" id="slf4j-depends">
<thead>
<tr class="row-odd"><th class="head"><p>Solución</p></th>
<th class="head"><p>Especificación</p></th>
<th class="head"><p>Implementación</p></th>
<th class="head"><p>Vínculo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><abbr title="Simple Logging Facade For Java">SLF4J</abbr> + Simple</p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api">slf4j-api</a></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-simple">slf4j-simple</a></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><abbr title="Simple Logging Facade For Java">SLF4J</abbr> + <a class="reference external" href="https://logback.qos.ch/">Logback</a></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api">slf4j-api</a></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/ch.qos.logback/logback-classic">logback-classic</a></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><abbr title="Simple Logging Facade For Java">SLF4J</abbr> + <a class="reference external" href="https://logging.apache.org/log4j/2.x/index.html">Log4J</a></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api">slf4j-api</a></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core">log4j-core</a></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-reload4j">slf4j-reload4j</a></p></td>
</tr>
<tr class="row-odd"><td><p><abbr title="Simple Logging Facade For Java">SLF4J</abbr> + <abbr title="java.util.logging">JUL</abbr></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api">slf4j-api</a></p></td>
<td><p>Incluida en <abbr title="Java Development Kit">JDK</abbr></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/jul-to-slf4j">jul-to-slf4j</a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="clasificacion-de-mensajes">
<span id="loglevel"></span><h3><span class="section-number">3.1.2. </span>Clasificación de mensajes<a class="headerlink" href="#clasificacion-de-mensajes" title="Link to this heading">#</a></h3>
<p>En estos sistemas los mensajes se envían para su registro clasificándolos con
dos criterios distintos:</p>
<ul>
<li><p>El <em>asunto del mensaje</em>, que en los sistemas de registros de <em>Java</em> se asimila
a la clase que origina el mensaje. Ya profundizaremos en ello cuando veamos
<a class="reference internal" href="#logging-uso"><span class="std std-ref">cómo enviar mensajes</span></a>.</p></li>
<li><p>La gravedad del mensaje, que en <abbr title="Simple Logging Facade For Java">SLF4J</abbr> puede ser de menor a mayor:</p>
<div class="pst-scrollable-table-container"><table class="table" id="loglevel-slf4j">
<thead>
<tr class="row-odd"><th class="head"><p>Nombre</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TRACE</p></td>
<td><p>Nivel de detalle muy, muy fino.</p></td>
</tr>
<tr class="row-odd"><td><p>DEBUG</p></td>
<td><p>Nivel propio de la depuración.</p></td>
</tr>
<tr class="row-even"><td><p>INFO</p></td>
<td><p>Mensajes sobre el funcionamiento habitual.</p></td>
</tr>
<tr class="row-odd"><td><p>WARN</p></td>
<td><p>Mensajes que indican circunstancias problemáticas.</p></td>
</tr>
<tr class="row-even"><td><p>ERROR</p></td>
<td><p>Mensajes de error que requieren atención inmediata.</p></td>
</tr>
</tbody>
</table>
</div>
<p>En ausencia de <a class="reference internal" href="#logging-conf"><span class="std std-ref">configuración adicional</span></a>, el sistema
muestra mensajes a partir del nivel <em>DEBUG</em>.</p>
</li>
</ul>
</section>
</section>
<section id="envio-de-mensajes">
<span id="logging-uso"></span><h2><span class="section-number">3.2. </span>Envío de mensajes<a class="headerlink" href="#envio-de-mensajes" title="Link to this heading">#</a></h2>
<p>Para enviar mensajes lo primero es obtener una instancia <a class="extlink-java-slf4j reference external" href="https://www.slf4j.org/api/org/slf4j/Logger.html">Logger</a> a
partir de <a class="extlink-java-slf4j reference external" href="https://www.slf4j.org/api/org/slf4j/LoggerFactory.html">LoggerFactory</a>. La convención es que se cree una
instancia por clase y pasar como parámetro la propia clase para identificar lo
que hemos llamado antes el <em>asunto del mensaje</em>:</p>
<div class="highlight-java notranslate" id="def-logger"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CentroSqlDao</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Crud</span><span class="o">&lt;</span><span class="n">Centro</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="c1">// logger servirá para registrar todos los mensajes</span>
<span class="w">   </span><span class="c1">// que se envían desde la clase.</span>
<span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">CentroSqlDao</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="w">   </span><span class="c1">// Implementación de la clase.</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Obtener el <em>logger</em> proporcionando la clase es equivalente a pasar una
cadena con el nombre completo de la clase. Dicho de otra forma:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">CentroSqlDao</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">CentroSqlDao</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span><span class="w">  </span><span class="c1">// true</span>
</pre></div>
</div>
<p>En realidad, lo que identifica a los <em>logger</em> es la cadena; y podríamos hacer
que varias clases compartieran un mismo <em>logger</em> simplemente generando para
todas ellas <em>loggers</em> que comparten la misma cadena (aunque la práctica
habitual es definir un <em>logger</em> por clase):</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">edu.acceso.test.backend.sql</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CentroSqlDao</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Crud</span><span class="o">&lt;</span><span class="n">Centro</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="c1">// Se usa para definir el logger el nombre del paquete, no de la clase.</span>
<span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">CentroSqlDao</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getPackageName</span><span class="p">());</span>

<span class="w">   </span><span class="c1">// Implementación...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">edu.acceso.test.backend.sql</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EstudianteSqlDao</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Crud</span><span class="o">&lt;</span><span class="n">Estudiante</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="c1">// Este logger es el mismo que el de CentroSqlDao.</span>
<span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">EstudianteSqlDao</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getPackageName</span><span class="p">());</span>

<span class="w">   </span><span class="c1">// Implementación...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Una vez que disponemos de un objeto <a class="extlink-java-slf4j reference external" href="https://www.slf4j.org/api/org/slf4j/Logger.html">Logger</a>, podemos registrar los
mensajes con métodos que reproducen el nivel de gravedad:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Este es un mensaje fatal&quot;</span><span class="p">);</span>
<span class="n">logger</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Esta es una advertencia que puede ser importante conocer&quot;</span><span class="p">);</span>
<span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;Este mensaje informa de que la aplicación ha hecho algo&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Este mensaje sirve para depurar el comportamiento de la aplicación&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Este mensaje permite seguir muy concienzudamente la ejecución de la aplicación&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Ha de tenerse en cuenta que, dependiendo del nivel que se haya definido como
registrable, los mensajes se registrarán de modo efectivo o no lo harán. Es
importante tenerlo presente porque muy habitualmente los mensajes no son meras
frases como las de arriba, sino que incluyen valores:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Se ha registrado el centro con código {} y nombre {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">centro</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span><span class="w"> </span><span class="n">centro</span><span class="p">.</span><span class="na">getNombre</span><span class="p">());</span>
</pre></div>
</div>
<p>Como se ve, se incluye una sintaxis para poder incluir valores dentro del
mensaje sin recurrir a <code class="docutils literal notranslate"><span class="pre">String.format</span></code>.</p>
<p>En todos los casos anteriores, si se quiere proporcionar un error para que se
registre, puede proporcionarse como argumento adicional al final:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// e es una Excepción.</span>
<span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Se ha registrado el centro con código {} y nombre {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">centro</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span><span class="w"> </span><span class="n">centro</span><span class="p">.</span><span class="na">getNombre</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
</pre></div>
</div>
<p>Ahora bien, en el ejemplo dado obtener ambos valores es muy económico ya que
simplemente invocamos dos <em>getters</em>, por lo que el hecho de que se evalúen esos
dos parámetros, aunque luego no acabe por escribirse el mensaje, no penaliza
demasiado el rendimiento. Ahora bien, si la obtención del valor es costosa,
¿cómo evitaríamos la merma improductiva de rendimiento? Para ello, a partir de
la versión 2 de <abbr title="Simple Logging Facade For Java">SLF4J</abbr>, existe una <abbr title="Application Programming Interface">API</abbr> fluida que permite usar una expresión
lambda como argumento:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Se supone que lo que se guarda es la fecha de nacimiento y la edad es calculada.</span>
<span class="n">logger</span><span class="p">.</span><span class="na">atWarn</span><span class="p">().</span><span class="na">log</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span>
<span class="w">   </span><span class="s">&quot;Se evita el registro porque el estudiante ID=%d tiene %d años&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="n">estudiante</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span>
<span class="w">   </span><span class="n">estudiante</span><span class="p">.</span><span class="na">getEdad</span><span class="p">()</span>
<span class="p">));</span>
</pre></div>
</div>
<p>Una variante a esto último que permite pasar los parámetros como argumento, en
vez de recurrir a <code class="docutils literal notranslate"><span class="pre">String.format</span></code> es:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="p">.</span><span class="na">atWarn</span><span class="p">()</span>
<span class="w">      </span><span class="p">.</span><span class="na">addArgument</span><span class="p">(</span><span class="n">estudiante</span><span class="p">.</span><span class="na">getId</span><span class="p">())</span>
<span class="w">      </span><span class="p">.</span><span class="na">addArgument</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">estudiante</span><span class="p">.</span><span class="na">getEdad</span><span class="p">())</span><span class="w"> </span><span class="c1">// Este es costoso.</span>
<span class="w">      </span><span class="p">.</span><span class="na">setCause</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w">   </span><span class="c1">// Opcional, si quisiéramos pasar un error.</span>
<span class="w">      </span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&quot;Se evita el registro porque el estudiante ID={} tiene {} años&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Con todo esto, ya sabemos sobradamente enviar mensajes al registro indicando qué
nivel de gravedad tienen.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En versiones anteriores a la 2, la única forma de sortear la
evaluación gratuita de expresiones costosas era usar condiciones:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isWarnEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">logger</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span>
<span class="w">      </span><span class="s">&quot;Se evita el registro porque el estudiante ID={} tiene {} años&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">estudiante</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span>
<span class="w">      </span><span class="n">estudiante</span><span class="p">.</span><span class="na">getEdad</span><span class="p">()</span>
<span class="w">   </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="configuracion-adicional">
<span id="logging-conf"></span><h2><span class="section-number">3.3. </span>Configuración adicional<a class="headerlink" href="#configuracion-adicional" title="Link to this heading">#</a></h2>
<div class="admonition caution">
<p class="admonition-title">Prudencia</p>
<p><abbr title="Simple Logging Facade For Java">SLF4J</abbr> se limita a especificar el envío de mensajes, por lo que
toda la configuración adicional que queramos hacer a ese envío depende de
la librería de implementación. En nuestro caso, este apartado se centra e
cómo configurar <a class="reference external" href="https://logback.qos.ch/">Logback</a>.</p>
</div>
<p>Pese a que ya sabemos cómo enviar mensajes, no es aún suficiente. Es muy común
que, además, necesitemos al menos:</p>
<ul class="simple">
<li><p>Definir sobre qué soporte se registrarán los mensajes.</p></li>
<li><p>Definir a partir de qué nivel los mensajes se registrarán.</p></li>
<li><p>Definir el formato de los mensajes.</p></li>
</ul>
<p>La configuracíón <strong>predeterminada</strong> es la siguiente:</p>
<ol class="loweralpha">
<li><p>Los mensajes se escriben en la salida estándar (o sea, en <code class="docutils literal notranslate"><span class="pre">System.out</span></code>).</p></li>
<li><p>El nivel registrable, esto es, el nivel a partir del cual los mensajes se
registran en el soporte, es <strong>DEBUG</strong>.</p></li>
<li><p>El formato de salida tiene este formato:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
</pre></div>
</div>
<p>Lo que generaría un mensaje como:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>14:23:45.678 [main] DEBUG edu.acceso.test.MiClase - Mensaje de depuración.
</pre></div>
</div>
</li>
</ol>
<p>Por otro lado, estas configuraciones pueden ser estáticas o dinámicas. Las
primeras consisten en leer un archivo, mientras que las segundas permiten
definir la configuración dentro del código en tiempo de ejecución.</p>
<section id="estatica">
<h3><span class="section-number">3.3.1. </span>Estática<a class="headerlink" href="#estatica" title="Link to this heading">#</a></h3>
<p>La configuración estática se realiza nativamente a través de un archivo <abbr title="eXtensible Markup Language">XML</abbr> o
Groovy. Debe colocarse en el directorio <code class="file docutils literal notranslate"><span class="pre">resources</span></code> (en un proyecto
Maven o Gradle) y denominarse <cite>logback.xml</cite>.</p>
<p>Un ejemplo sencillo de configuración podría ser este:</p>
<div class="literal-block-wrapper docutils container" id="logback-basico-xml">
<div class="code-block-caption"><span class="caption-text">logback.xml</span><a class="headerlink" href="#logback-basico-xml" title="Link to this code">#</a></div>
<div class="toggle highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;configuration</span><span class="w"> </span><span class="na">debug=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="cm">&lt;!-- Definición de un soporte --&gt;</span>
<span class="w">   </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CONSOLE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;target&gt;</span>System.err<span class="nt">&lt;/target&gt;</span>
<span class="w">      </span><span class="nt">&lt;encoder&gt;</span>
<span class="w">         </span><span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS}<span class="w"> </span>[%thread]<span class="w"> </span>%-5level<span class="w"> </span>%logger{36}<span class="w"> </span>-<span class="w"> </span>%msg%n<span class="nt">&lt;/pattern&gt;</span>
<span class="w">      </span><span class="nt">&lt;/encoder&gt;</span>
<span class="w">   </span><span class="nt">&lt;/appender&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- El logger raíz (y todos sus descendiente) tienen esta configuración --&gt;</span>
<span class="w">   </span><span class="nt">&lt;root</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;INFO&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;CONSOLE&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>El atributo <code class="docutils literal notranslate"><span class="pre">debug</span></code> provoca que se vuelquen en la consola mensajes
relacionados con el procesamiento inicial del archivo de configuración. Para
una depuración más extensa puede usarse en cambio:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;configuration&gt;</span>
<span class="w">   </span><span class="nt">&lt;statusListener</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.status.OnConsoleStatusListener&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">   </span><span class="cm">&lt;!-- Resto de configuración --&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
<p>Puede consultarse <a class="reference external" href="https://logback.qos.ch/apidocs/ch.qos.logback.core/ch/qos/logback/core/status/package-summary.html">ch.qos.logback.core.status</a>
para ver otras posibles salidas distintas a la consola.</p>
</div>
<p>En caso de querer definir archivos como soporte de salida, podemos hacer:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Ejemplo de registros en archivo</span><a class="headerlink" href="#id3" title="Link to this code">#</a></div>
<div class="toggle highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- Appender para archivo simple --&gt;</span>
<span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;FILE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.FileAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;file&gt;</span>logs/app.log<span class="nt">&lt;/file&gt;</span>
<span class="w">    </span><span class="nt">&lt;append&gt;</span>true<span class="nt">&lt;/append&gt;</span><span class="w"> </span><span class="cm">&lt;!-- Conserva logs anteriores --&gt;</span>
<span class="w">    </span><span class="nt">&lt;encoder&gt;</span>
<span class="w">        </span><span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS}<span class="w"> </span>[%thread]<span class="w"> </span>%-5level<span class="w"> </span>%logger{36}<span class="w"> </span>-<span class="w"> </span>%msg%n<span class="nt">&lt;/pattern&gt;</span>
<span class="w">    </span><span class="nt">&lt;/encoder&gt;</span>
<span class="nt">&lt;/appender&gt;</span>

<span class="cm">&lt;!-- Appender para rotación automática --&gt;</span>
<span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ROLLING_FILE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.RollingFileAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;file&gt;</span>logs/app.log<span class="nt">&lt;/file&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- Este conserva registros anteriores sin necesidad de append: true --&gt;</span>
<span class="w">    </span><span class="nt">&lt;encoder&gt;</span>
<span class="w">        </span><span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS}<span class="w"> </span>[%thread]<span class="w"> </span>%-5level<span class="w"> </span>%logger{36}<span class="w"> </span>-<span class="w"> </span>%msg%n<span class="nt">&lt;/pattern&gt;</span>
<span class="w">    </span><span class="nt">&lt;/encoder&gt;</span>
<span class="w">    </span><span class="nt">&lt;rollingPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- Formato de archivos rotados: fecha + índice --&gt;</span>
<span class="w">        </span><span class="nt">&lt;fileNamePattern&gt;</span>logs/app.%d{yyyy-MM-dd}.%i.log<span class="nt">&lt;/fileNamePattern&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- Máximo 10MB por archivo --&gt;</span>
<span class="w">        </span><span class="nt">&lt;maxFileSize&gt;</span>10MB<span class="nt">&lt;/maxFileSize&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- Conserva 30 días de logs --&gt;</span>
<span class="w">        </span><span class="nt">&lt;maxHistory&gt;</span>30<span class="nt">&lt;/maxHistory&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- Tamaño máximo total de todos los archivos --&gt;</span>
<span class="w">        </span><span class="nt">&lt;totalSizeCap&gt;</span>1GB<span class="nt">&lt;/totalSizeCap&gt;</span>
<span class="w">    </span><span class="nt">&lt;/rollingPolicy&gt;</span>
<span class="nt">&lt;/appender&gt;</span>
</pre></div>
</div>
</div>
<p>Debe tenerse presente que las rutas son relativas al directorio de trabajo. Las
rutas podrían ser absolutas, pero en ese caso la configuración dependería de
cuál fuera el sistema en el que corre la operación. Para evitarlo tenemos
alternativas:</p>
<ul>
<li><p>Pasar variables a Java al ejecutar la aplicación usando la opción <cite>-D</cite>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;file&gt;</span>${LOG_DIR}/app.log<span class="nt">&lt;/file&gt;</span>
</pre></div>
</div>
<p>En este caso, si hubiéramos ejecutado así la aplicación:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>java<span class="w"> </span>-DLOG_DIR<span class="o">=</span>/var/log<span class="w"> </span>-jar<span class="w"> </span>app.jar
</pre></div>
</div>
<p>La ruta del archivo sería <code class="file docutils literal notranslate"><span class="pre">/var/log/app.log</span></code>. Ahora bien corremos el
riesgo de que la aplicación se ejecute sin pasar ningún valor a la variable.
Para evitarlo podemos definir un valor predeterminado dentro del archivo de
configuración:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;configuration&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LOG_DIR&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;logs&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- Resto de configuración --&gt;</span>

<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</li>
<li><p>Variables de ambiente (que dependen del sistema, por cierto):</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;file&gt;</span>${env.HOME}/app.log<span class="nt">&lt;/file&gt;</span>
</pre></div>
</div>
<p>Para las variables de ambiente, sin embargo, no es tan fácil fijar un valor
predeterminado, porque no se les puede dar valor con <code class="docutils literal notranslate"><span class="pre">&lt;property&gt;</span></code> como en el
caso anterior.</p>
</li>
<li><p>Valores de <a class="reference internal" href="../01.archivos/01.gestion.html#system-properties"><span class="std std-ref">propiedades del sistema de Java</span></a>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- En un sistema UNIX esto equivale a /tmp/app.log --&gt;</span>
<span class="nt">&lt;file&gt;</span>${java.io.tmpdir}/app.log<span class="nt">&lt;/file&gt;</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Truco</p>
<p>En un sistema UNIX también existe la posibilidad de integrar los
mensajes en los registros del sistema:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Ejemplo de registros con syslog</span><a class="headerlink" href="#id4" title="Link to this code">#</a></div>
<div class="toggle highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- Appender para Syslog clásico --&gt;</span>
<span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;SYSLOG&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.net.SyslogAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;syslogHost&gt;</span>localhost<span class="nt">&lt;/syslogHost&gt;</span>
<span class="w">    </span><span class="nt">&lt;port&gt;</span>514<span class="nt">&lt;/port&gt;</span>
<span class="w">    </span><span class="nt">&lt;facility&gt;</span>LOCAL0<span class="nt">&lt;/facility&gt;</span>
<span class="w">    </span><span class="nt">&lt;suffixPattern&gt;</span>[%thread]<span class="w"> </span>%logger{36}<span class="w"> </span>-<span class="w"> </span>%msg<span class="nt">&lt;/suffixPattern&gt;</span>
<span class="w">    </span><span class="nt">&lt;stackTracePattern&gt;</span><span class="w">   </span>%ex{full}<span class="nt">&lt;/stackTracePattern&gt;</span>
<span class="w">    </span><span class="nt">&lt;tag&gt;</span>MiApp<span class="nt">&lt;/tag&gt;</span>
<span class="nt">&lt;/appender&gt;</span>

<span class="cm">&lt;!-- Appender para Journald con syslog --&gt;</span>
<span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;JOURNAL_SYSLOG&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.net.SyslogAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;syslogHost&gt;</span>/run/systemd/journal/syslog<span class="nt">&lt;/syslogHost&gt;</span>
<span class="w">    </span><span class="nt">&lt;port&gt;</span>-1<span class="nt">&lt;/port&gt;</span><span class="w">  </span><span class="cm">&lt;!-- Usa -1 para sockets Unix --&gt;</span>
<span class="w">    </span><span class="nt">&lt;facility&gt;</span>LOCAL0<span class="nt">&lt;/facility&gt;</span>
<span class="w">    </span><span class="nt">&lt;suffixPattern&gt;</span>[%thread]<span class="w"> </span>%logger{36}<span class="w"> </span>-<span class="w"> </span>%msg<span class="nt">&lt;/suffixPattern&gt;</span>
<span class="w">    </span><span class="nt">&lt;stackTracePattern&gt;</span><span class="w">   </span>%ex{full}<span class="nt">&lt;/stackTracePattern&gt;</span>
<span class="w">    </span><span class="nt">&lt;tag&gt;</span>MiApp<span class="nt">&lt;/tag&gt;</span>
<span class="nt">&lt;/appender&gt;</span>
</pre></div>
</div>
</div>
</div>
<p>Por supuesto, si hemos definido múltiples soportes, podemos indicar que se
registros los mensajes en varios de ellos:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;root</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;INFO&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;CONSOLE&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;FILE&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>
</div>
<p>Queda un último aspecto básico por revisar y es cómo configurar un logger
específico, ya que recordemos que, cuando hemos definido los logger en las clases
<a class="reference internal" href="#def-logger"><span class="std std-ref">los referíamos con la propia clase</span></a>. Supongamos que en aquel
ejemplo la clase <code class="docutils literal notranslate"><span class="pre">CentroSqlDao</span></code> está dentro del paquete
<code class="docutils literal notranslate"><span class="pre">edu.acceso.test.backend.sql</span></code>. En ese caso:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- appenders, etc. --&gt;</span>

<span class="nt">&lt;root</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;INFO&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;CONSOLE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/root&gt;</span>

<span class="cm">&lt;!-- Loggers específicos --&gt;</span>
<span class="nt">&lt;logger</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;edu.acceso.test.backend.sql&quot;</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;DEBUG&quot;</span><span class="w"> </span><span class="na">additivity=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;FILE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/logger&gt;</span>

<span class="nt">&lt;logger</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;edu.acceso.test.backend.sql.sqlite&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="nt">&lt;logger</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;jakarta.persistence&quot;</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;WARN&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>En esta configuración, los logs de la aplicación se han aplicado para que se
registren los mensajes a partir del nivel <strong>INFO</strong> en la consola.
Pero, además, se han hecho tres configuraciones adicionales. Tengase presente
que, en principio, los valores de <code class="docutils literal notranslate"><span class="pre">level</span></code> y <code class="docutils literal notranslate"><span class="pre">appender-ref</span></code> se heredan de
padres a hijos. En el caso de <code class="docutils literal notranslate"><span class="pre">level</span></code> un redefinición, cambia el valor; pero
en el caso de <code class="docutils literal notranslate"><span class="pre">appender-ref</span></code>, una redefinición tiene carácter acomulativo. Por
tanto:</p>
<ul class="simple">
<li><p>El código incluido dentro de una librería externa (<code class="docutils literal notranslate"><span class="pre">jakarta.persistence</span></code>)
sólo registrará mensajes de advertencia y de error (redefinición de <code class="docutils literal notranslate"><span class="pre">level</span></code>);
en la consola (no se ha redefinido <code class="docutils literal notranslate"><span class="pre">appender-ref</span></code>).</p></li>
<li><p>El código incluido en el paquete <code class="docutils literal notranslate"><span class="pre">edu.acceso.test.backend.sql</span></code> (dentro del
cual está la clase <code class="docutils literal notranslate"><span class="pre">CentroSqlDao</span></code>) registra mensajes a partir del nivel
<strong>DEBUG</strong> (redefinición de <code class="docutils literal notranslate"><span class="pre">level</span></code>) y en principio debería registrarlos
tanto en la consola como en el archivo. Pero se ha añadido <code class="docutils literal notranslate"><span class="pre">additivity</span></code> con
valor <code class="docutils literal notranslate"><span class="pre">false</span></code>. Esta propiedad no es heredable y afecta al valor de
<code class="docutils literal notranslate"><span class="pre">appender-ref</span></code>. Implica que el <em>logger</em> sólo usa los soportes que tenga
definidos. Por tanto, los registros se escriben exclusivamente en el archivo.</p></li>
<li><p>El paquete <code class="docutils literal notranslate"><span class="pre">edu.acceso.test.backend.sql.sqlite</span></code> hereda el valor <code class="docutils literal notranslate"><span class="pre">level</span></code>
del padre; y por tanto, registra mensajes a partir de <strong>DEBUG</strong>. En cuanto a
los soportes, como no tiene definido <code class="docutils literal notranslate"><span class="pre">additivity</span></code> su valor es <code class="docutils literal notranslate"><span class="pre">true</span></code> y
hereda: registrará los mensajes en consola, porque hereda de <code class="docutils literal notranslate"><span class="pre">root</span></code>. Sin
embargo, no registrará en el archivo, porque el padre tenía su <code class="docutils literal notranslate"><span class="pre">additivity</span></code>
a <code class="docutils literal notranslate"><span class="pre">false</span></code> y eso implica que no comparte los soportes con los hijos.</p></li>
</ul>
</section>
<section id="dinamica">
<h3><span class="section-number">3.3.2. </span>Dinámica<a class="headerlink" href="#dinamica" title="Link to this heading">#</a></h3>
<p>La configuración estática que acabamos de ver permite configurar el sistema de
registros a priori. Sin embargo, es posible que deseemos realizar alguna
configuración adicional en tiempo de ejecución debido, por ejemplo, a que
permitamos incluir un argumento que indique el nivel a partir del cuál queremos
registrar mensajes u otro que defina su soporte (p.e. cuál es la ruta del
archivo).</p>
<p>Para lograrlo necesitaremos establecer el nivel registrable o los soportes de
salida para los distintos <em>loggers</em>, pero en vez de en un archivo de
configuración, a través de instrucción de Java. Comencemos por aprender cómo se
establece el nivel a partir del cual se registran mensajes.</p>
<p class="rubric">Definición del nivel</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// ¡Ojo! Los de Logback, no los de SLF4J</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ch.qos.logback.classic.Logger</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ch.qos.logback.classic.Level</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="c1">// Raíz.</span>
<span class="n">Logger</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Logger</span><span class="p">)</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">org</span><span class="p">.</span><span class="na">slf4j</span><span class="p">.</span><span class="na">Logger</span><span class="p">.</span><span class="na">ROOT_LOGGER_NAME</span><span class="p">);</span>
<span class="n">root</span><span class="p">.</span><span class="na">setLevel</span><span class="p">(</span><span class="n">Level</span><span class="p">.</span><span class="na">WARN</span><span class="p">);</span>
</pre></div>
</div>
<p>De igual modo, se puede redefinir el nivel registrable para cualquier otro
<em>logger</em> particular.</p>
<p class="rubric">Definición de soportes de salida.</p>
<p>La definición de soportes de salida es más trabajosa, pero sigue la misma
filosofía: debemos definir las características del <em>appender</em> (para lo cual nos
es muy útil conocer cómo se configura estáticamente) y añadirlo al <em>logger</em> que
decidamos. En los ejemplos usaremos <code class="docutils literal notranslate"><span class="pre">root</span></code>, pero puede ser cualquier otro
particular.</p>
<dl>
<dt><a class="reference external" href="https://www.javadoc.io/doc/ch.qos.logback/logback-core/latest/ch.qos.logback.core/ch/qos/logback/core/ConsoleAppender.html">ConsoleAppender</a></dt><dd><p>Para definir la salida por consola:</p>
<div class="literal-block-wrapper docutils container" id="console-appender-dyn">
<div class="code-block-caption"><span class="caption-text">Configurar ConsoleAppender</span><a class="headerlink" href="#console-appender-dyn" title="Link to this code">#</a></div>
<div class="toggle highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">LoggerContext</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">LoggerContext</span><span class="p">)</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getILoggerFactory</span><span class="p">();</span>

<span class="c1">// Definición del formato del mensaje</span>
<span class="n">PatternLayoutEncoder</span><span class="w"> </span><span class="n">encoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PatternLayoutEncoder</span><span class="p">();</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">setPattern</span><span class="p">(</span><span class="s">&quot;%d{HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n&quot;</span><span class="p">);</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// Creamos el soporte</span>
<span class="n">ConsoleAppender</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConsoleAppender</span><span class="p">();</span>
<span class="n">console</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">console</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;CONSOLE&quot;</span><span class="p">);</span>
<span class="n">console</span><span class="p">.</span><span class="na">setEncoder</span><span class="p">(</span><span class="n">encoder</span><span class="p">);</span>
<span class="n">console</span><span class="p">.</span><span class="na">setTarget</span><span class="p">(</span><span class="s">&quot;System.err&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Por defecto es System.out</span>
<span class="n">console</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// Añadimos el appender a un logger</span>
<span class="n">root</span><span class="p">.</span><span class="na">addAppender</span><span class="p">(</span><span class="n">console</span><span class="p">);</span>
</pre></div>
</div>
</div>
</dd>
<dt><a class="reference external" href="https://www.javadoc.io/doc/ch.qos.logback/logback-core/latest/ch.qos.logback.core/ch/qos/logback/core/FileAppender.html">FileAppender</a></dt><dd><p>La definición de un archivo de salida se hace así:</p>
<div class="literal-block-wrapper docutils container" id="file-appender-dyn">
<div class="code-block-caption"><span class="caption-text">Configurar FileAppender</span><a class="headerlink" href="#file-appender-dyn" title="Link to this code">#</a></div>
<div class="toggle highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">LoggerContext</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">LoggerContext</span><span class="p">)</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getILoggerFactory</span><span class="p">();</span>

<span class="c1">// Definición del formato del mensaje</span>
<span class="n">PatternLayoutEncoder</span><span class="w"> </span><span class="n">encoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PatternLayoutEncoder</span><span class="p">();</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">setPattern</span><span class="p">(</span><span class="s">&quot;%d{HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n&quot;</span><span class="p">);</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

<span class="n">Path</span><span class="w"> </span><span class="n">archivo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;java.io.tmpfile&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;app.log&quot;</span><span class="p">);</span>

<span class="c1">// Creamos el soporte</span>
<span class="n">FileAppender</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileAppender</span><span class="p">();</span>
<span class="n">file</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">file</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;FILE&quot;</span><span class="p">);</span>
<span class="n">file</span><span class="p">.</span><span class="na">setEncoder</span><span class="p">(</span><span class="n">encoder</span><span class="p">);</span>
<span class="n">file</span><span class="p">.</span><span class="na">setAppend</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="n">file</span><span class="p">.</span><span class="na">setFile</span><span class="p">(</span><span class="n">archivo</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
<span class="n">file</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// Añadimos el appender a un logger</span>
<span class="n">root</span><span class="p">.</span><span class="na">addAppender</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
</pre></div>
</div>
</div>
</dd>
<dt><a class="reference external" href="https://www.javadoc.io/doc/ch.qos.logback/logback-core/latest/ch.qos.logback.core/ch/qos/logback/core/rolling/RollingFileAppender.html">RollingFileAppender</a></dt><dd><p>Si deseamos rotación de archivos:</p>
<div class="literal-block-wrapper docutils container" id="rollingfile-appender-dyn">
<div class="code-block-caption"><span class="caption-text">Configurar RollingFileAppender</span><a class="headerlink" href="#rollingfile-appender-dyn" title="Link to this code">#</a></div>
<div class="toggle highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">LoggerContext</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">LoggerContext</span><span class="p">)</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getILoggerFactory</span><span class="p">();</span>

<span class="c1">// Definición del formato del mensaje</span>
<span class="n">PatternLayoutEncoder</span><span class="w"> </span><span class="n">encoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PatternLayoutEncoder</span><span class="p">();</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">setPattern</span><span class="p">(</span><span class="s">&quot;%d{HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n&quot;</span><span class="p">);</span>
<span class="n">encoder</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

<span class="n">Path</span><span class="w"> </span><span class="n">ruta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Path</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;java.io.tmpfile&quot;</span><span class="p">));</span>

<span class="n">SizeAndTimeBasedRollingPolicy</span><span class="w"> </span><span class="n">rollingPolicy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SizeAndTimeBasedRollingPolicy</span><span class="p">();</span>
<span class="n">rollingPolicy</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">rollingPolicy</span><span class="p">.</span><span class="na">setFileNamePattern</span><span class="p">(</span><span class="n">ruta</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;app.%d{yyyy-MM-dd}.%i.log&quot;</span><span class="p">);</span>
<span class="n">rollingPolicy</span><span class="p">.</span><span class="na">setMaxFileSize</span><span class="p">(</span><span class="s">&quot;10MB&quot;</span><span class="p">);</span>
<span class="n">rollingPolicy</span><span class="p">.</span><span class="na">setMaxHistory</span><span class="p">(</span><span class="mi">30</span><span class="p">);</span>
<span class="n">rollingPolicy</span><span class="p">.</span><span class="na">setTotalSizeCap</span><span class="p">(</span><span class="s">&quot;1GB&quot;</span><span class="p">);</span>
<span class="n">rollingPolicy</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>


<span class="c1">// Creamos el soporte</span>
<span class="n">RollingFileAppender</span><span class="w"> </span><span class="n">rollingFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RollingFileAppender</span><span class="p">();</span>
<span class="n">rollingFile</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">rollingFile</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;ROLLING_FILE&quot;</span><span class="p">);</span>
<span class="n">rollingFile</span><span class="p">.</span><span class="na">setEncoder</span><span class="p">(</span><span class="n">encoder</span><span class="p">);</span>
<span class="n">rollingFile</span><span class="p">.</span><span class="na">setFile</span><span class="p">(</span><span class="n">ruta</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;app.log&quot;</span><span class="p">);</span>
<span class="n">rollingFile</span><span class="p">.</span><span class="na">setRollingPolicy</span><span class="p">(</span><span class="n">rollingPolicy</span><span class="p">);</span>
<span class="n">rollingFile</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// Añadimos el appender a un logger</span>
<span class="n">root</span><span class="p">.</span><span class="na">addAppender</span><span class="p">(</span><span class="n">rollingFile</span><span class="p">);</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<p>El nombre que se le da al <em>appender</em> (p.e. «<em>CONSOLE</em>»), nos permite rescatarlo
en otra parte del código siempre que se haya adjuntado a algún logger. Por
ejemplo:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Logger</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Logger</span><span class="p">)</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">org</span><span class="p">.</span><span class="na">slf4j</span><span class="p">.</span><span class="na">Logger</span><span class="p">.</span><span class="na">ROOT_LOGGER_NAME</span><span class="p">);</span>
<span class="n">ConsoleAppender</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ConsoleAppender</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="na">getAppender</span><span class="p">(</span><span class="s">&quot;CONSOLE&quot;</span><span class="p">);</span>

<span class="c1">// Lo manipulamos, si es nuestra intención</span>
<span class="n">console</span><span class="p">.</span><span class="na">setTarget</span><span class="p">(</span><span class="s">&quot;System.out&quot;</span><span class="p">);</span>

<span class="c1">// También se puede eliminar de un logger.</span>

<span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Logger</span><span class="p">)</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="s">&quot;edu.acceso.test.backend.sql&quot;</span><span class="p">);</span>
<span class="n">logger</span><span class="p">.</span><span class="na">detachAppender</span><span class="p">(</span><span class="s">&quot;FILE&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Por supuesto, si <em>CONSOLE</em> se definió en el archivo de
configuración y se usó en algún <em>logger</em>, se podrá obtener en el código sin
tener que definirlo.</p>
</div>
<p>Otro aspecto importante es el aportado por <code class="docutils literal notranslate"><span class="pre">additivity</span></code> que ya se discutió
anteriormente. Programáticamente, también se puede, definir para un <em>logger</em>
particular:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Logger</span><span class="p">)</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="s">&quot;edu.acceso.test.backend.sql&quot;</span><span class="p">);</span>
<span class="n">logger</span><span class="p">.</span><span class="na">setAdditivity</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="particularidades">
<h2><span class="section-number">3.4. </span>Particularidades<a class="headerlink" href="#particularidades" title="Link to this heading">#</a></h2>
<p>Con lo tratado hasta aquí, podemos hacer una configuración sólida del sistema de
registros de nuestra aplicación. Hay, sin embargo, algunas particularidades que
en algún momento nos pueden resultar interesantes.</p>
<section id="filtrado-por-severidad">
<h3><span class="section-number">3.4.1. </span>Filtrado por severidad<a class="headerlink" href="#filtrado-por-severidad" title="Link to this heading">#</a></h3>
<p>En ocasiones nos interesa escoger el soporte en que se registrarán los mensajes
dependiendo de su gravedad. Por ejemplo, separar en dos archivos los registros:
un archivo para mensajes de error (<em>ERROR</em> y <em>WARN</em>) y otro para el resto. Esto
se logra definiendo dos <em>appenders</em> distintos y definiendo filtros en cada uno
de ellos. Por ejemplo:</p>
<div class="literal-block-wrapper docutils container" id="logging-filtrado-mensajes">
<div class="code-block-caption"><span class="caption-text">Soporte según la severidad el mensaje</span><a class="headerlink" href="#logging-filtrado-mensajes" title="Link to this code">#</a></div>
<div class="toggle highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;configuration&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- Appender para errores (WARN y superiores en System.err) --&gt;</span>
<span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CONSOLE_ERROR&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;target&gt;</span>System.err<span class="nt">&lt;/target&gt;</span>
<span class="hll"><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&lt;level&gt;</span>WARN<span class="nt">&lt;/level&gt;</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span class="w">        </span><span class="nt">&lt;encoder&gt;</span>
<span class="w">            </span><span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss}<span class="w"> </span>[%thread]<span class="w"> </span>%highlight(%-5level)<span class="w"> </span>-<span class="w"> </span>%msg%n<span class="nt">&lt;/pattern&gt;</span>
<span class="w">        </span><span class="nt">&lt;/encoder&gt;</span>
<span class="w">    </span><span class="nt">&lt;/appender&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- Appender para INFO y DEBUG (en System.out) --&gt;</span>
<span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CONSOLE_INFO&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;target&gt;</span>System.out<span class="nt">&lt;/target&gt;</span>
<span class="hll"><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&lt;level&gt;</span>INFO<span class="nt">&lt;/level&gt;</span>
</span><span class="hll"><span class="w">            </span><span class="cm">&lt;!-- Configuración inversa: DENY en coincidencia (INFO y superiores), ACCEPT en no coincidencia (DEBUG) --&gt;</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&lt;onMatch&gt;</span>DENY<span class="nt">&lt;/onMatch&gt;</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&lt;onMismatch&gt;</span>ACCEPT<span class="nt">&lt;/onMismatch&gt;</span>
</span><span class="hll"><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span class="w">        </span><span class="nt">&lt;encoder&gt;</span>
<span class="w">            </span><span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss}<span class="w"> </span>[%thread]<span class="w"> </span>%highlight(%-5level)<span class="w"> </span>-<span class="w"> </span>%msg%n<span class="nt">&lt;/pattern&gt;</span>
<span class="w">        </span><span class="nt">&lt;/encoder&gt;</span>
<span class="w">    </span><span class="nt">&lt;/appender&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- Logger raíz --&gt;</span>
<span class="w">    </span><span class="nt">&lt;root</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;DEBUG&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;CONSOLE_ERROR&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;CONSOLE_INFO&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</div>
<p>Si deseamos hacer una consulta dinámica, es necesario conocer cómo definir el
filtro y añadirlo al <em>appender</em>:</p>
<div class="highlight-java notranslate" id="logging-def-filtro"><div class="highlight"><pre><span></span><span class="n">ThresholdFilter</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Thresholdfilter</span><span class="p">();</span>
<span class="n">filter</span><span class="p">.</span><span class="na">setContext</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">setLevel</span><span class="p">(</span><span class="n">Level</span><span class="p">.</span><span class="na">INFO</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">setOnMatch</span><span class="p">(</span><span class="n">FilterReply</span><span class="p">.</span><span class="na">DENY</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">setOnMismatch</span><span class="p">(</span><span class="n">FilterReply</span><span class="p">.</span><span class="na">ACCEPT</span><span class="p">);</span>
<span class="n">filter</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// Añadir el filtro al appender</span>
<span class="n">console</span><span class="p">.</span><span class="na">setFilter</span><span class="p">(</span><span class="n">filter</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="puenteo-de-librerias">
<h3><span class="section-number">3.4.2. </span>Puenteo de librerías<a class="headerlink" href="#puenteo-de-librerias" title="Link to this heading">#</a></h3>
<p>Un problema muy recurrente con el que nos podemos encontrar se da cuando una
librería de terceros que queremos integrar en nuestra aplicación, usa una
implementación distinta (p.e. <a class="reference external" href="https://logging.apache.org/log4j/2.x/index.html">Log4J</a> o <abbr title="java.util.logging">JUL</abbr>) a la que hemos escogido nosotros
(<abbr title="Simple Logging Facade For Java">SLF4J</abbr> + <a class="reference external" href="https://logback.qos.ch/">Logback</a>). Para evitar el registro en distintos sistemas, existen
librerías que puentean entre la implementación que escogió la librería y
<abbr title="Simple Logging Facade For Java">SLF4J</abbr>.</p>
<div class="pst-scrollable-table-container"><table class="table" id="logging-bindings">
<thead>
<tr class="row-odd"><th class="head"><p>Framework</p></th>
<th class="head"><p>Librería de puenteo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><abbr title="java.util.logging">JUL</abbr></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/jul-to-slf4j">jul-to-slf4j</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://logging.apache.org/log4j/2.x/index.html">Log4J</a> v1</p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/log4j-over-slf4j">log4j-over-slf4j</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://logging.apache.org/log4j/2.x/index.html">Log4J</a> v2</p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-to-slf4j">log4j-to-slf4j</a></p></td>
</tr>
<tr class="row-odd"><td><p><abbr title="Apache Commons Logging">JLC</abbr></p></td>
<td><p><a class="reference external" href="https://mvnrepository.com/artifact/org.slf4j/jcl-over-slf4j">jcl-over-slf4j</a></p></td>
</tr>
</tbody>
</table>
</div>
<p>El modo de actuación en este caso sería:</p>
<ol class="loweralpha">
<li><p>Incluir entre las dependencias mi sistema de registro y la librería de
puenteo. En Maven sería:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- API de SLF4J --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
<span class="w">   </span><span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
<span class="w">   </span><span class="nt">&lt;artifactId&gt;</span>slf4j-api<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">   </span><span class="nt">&lt;version&gt;</span>2.1.0-alpha1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="cm">&lt;!-- Framework: Logback --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
<span class="w">   </span><span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
<span class="w">   </span><span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">   </span><span class="nt">&lt;version&gt;</span>1.5.18<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="cm">&lt;!-- Librería de puenteo  --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
<span class="w">   </span><span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
<span class="w">   </span><span class="nt">&lt;artifactId&gt;</span>jul-to-slf4j<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">   </span><span class="nt">&lt;version&gt;</span>2.1.0-alpha1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
</li>
<li><p>Al incluir como dependencia la librería que usa, a su vez, la librería de
implementación que quiero evitar (<abbr title="java.util.logging">JUL</abbr> en nuestro caso), debe decírsele al
gestor de proyectos (Maven en nuestro ejemplo), que evite instalar tal
librería de implementación:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- Librería de terceros que quiero usar --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
<span class="w">   </span><span class="nt">&lt;groupId&gt;</span>com.libreria.util<span class="nt">&lt;/groupId&gt;</span>
<span class="w">   </span><span class="nt">&lt;artifactId&gt;</span>que-usa-jul<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">   </span><span class="nt">&lt;version&gt;</span>0.2.5<span class="nt">&lt;/version&gt;</span>
<span class="w">   </span><span class="nt">&lt;exclusions&gt;</span>
<span class="w">      </span><span class="nt">&lt;exclusion&gt;</span>
<span class="w">         </span><span class="nt">&lt;groupId&gt;</span>log4j<span class="nt">&lt;/groupId&gt;</span>
<span class="w">         </span><span class="nt">&lt;artifactId&gt;</span>log4j<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">      </span><span class="nt">&lt;/exclusion&gt;</span>
<span class="w">   </span><span class="nt">&lt;/exclusions&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
</li>
<li><p>Con lo anterior ya bastaría para <em>engañar</em> a la librería de terceros, excepto
si la librería de terceros usa <abbr title="java.util.logging">JUL</abbr>, porque <abbr title="java.util.logging">JUL</abbr> está integrado en <abbr title="Java Development Kit">JDK</abbr>.
Si lo que queremos evitar es registrar con <abbr title="java.util.logging">JUL</abbr>, hay que añadir un código
adicional:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.bridge.SLF4JBridgeHandler</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Remueve los handlers de JUL</span>
<span class="w">      </span><span class="n">SLF4JBridgeHandler</span><span class="p">.</span><span class="na">removeHandlersForRootLogger</span><span class="p">();</span>
<span class="w">      </span><span class="c1">// Añade el bridge de SLF4J</span>
<span class="w">      </span><span class="n">SLF4JBridgeHandler</span><span class="p">.</span><span class="na">install</span><span class="p">();</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
<p class="rubric">Notas al pie</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Para una pequeña disertación sobre todas ellas consulter al <a class="reference external" href="https://www.marcobehler.com/guides/java-logging">artículo de
Marco Behler</a></p>
</aside>
</aside>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="05.pattern.html"
       title="página anterior">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Patrones de diseño</p>
      </div>
    </a>
    <a class="right-next"
       href="80.maven.html"
       title="siguiente página">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Maven</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminares">3.1. Preliminares</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencias">3.1.1. Dependencias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-mensajes">3.1.2. Clasificación de mensajes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#envio-de-mensajes">3.2. Envío de mensajes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracion-adicional">3.3. Configuración adicional</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estatica">3.3.1. Estática</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinamica">3.3.2. Dinámica</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#particularidades">3.4. Particularidades</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrado-por-severidad">3.4.1. Filtrado por severidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#puenteo-de-librerias">3.4.2. Puenteo de librerías</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por José Miguel Sánchez Alés
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright CC BY 4.0, 2024-2025, José Miguel Sánchez Alés.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>